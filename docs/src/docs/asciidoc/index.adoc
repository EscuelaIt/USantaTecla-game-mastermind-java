
= Mastermind. Solución 4.2. *dv.+factoryMethod*
Santa Tecla <parqueNaturalSantaTecla@gmail.com>
:toc-title: Índice
:toc: left

:idprefix:
:idseparator: -
:imagesdir: images

== Requisitos 2. *Gráficos*

[cols="50,50"]
|===

a|
- link:https://en.wikipedia.org/wiki/Mastermind_(board_game)[*Wiki*] - link:https://www.youtube.com/watch?v=2-hTeg2M6GQ[*Youtube*]
* _Funcionalidad: **Básica**_
* _Interfaz: *Gráfica* y **Texto**_
* _Distribución: **Standalone**_
* _Persistencia: **No**_

a|

image::Dibujo.jpg[]

|===

== Vista de Lógica/Diseño

- Arquitectura Documento/Vista mediante *Patrón de Vista Separada*
* [lime-background]*Patrón Template Method (Factory Method)*, _para clases principales_

=== Arquitectura 

[plantuml,aruitecturaVersion4,svg]
....
package mastermind #DDDDDD { } 
mastermind ..> mastermind.views
mastermind ..> mastermind.models
mastermind ..> mastermind.views.console
mastermind ..> mastermind.views.graphics

package mastermind.models #DDDDDD { } 
package java.util{ }
mastermind.models .down.> java.util

package mastermind.utils #DDDDDD { } 
package java.io{ }
mastermind.utils .down.> java.io

package mastermind.views #DDDDDD { } 
mastermind.views .down.> mastermind.models

package mastermind.views.console #DDDDDD { } 
mastermind.views.console .down.> mastermind.views
mastermind.views.console .down.> mastermind.models
mastermind.views.console .down.> mastermind.utils

package mastermind.views.graphics #DDDDDD { } 
package java.awt{ }
mastermind.views.graphics .down.> java.awt
package java.awt.event{ }
mastermind.views.graphics .down.> java.awt.event
mastermind.views.graphics .down.> mastermind.views
mastermind.views.graphics .down.> mastermind.models
package javax.swing{ }
mastermind.views.graphics .down.> javax.swing

....

=== Paquete _mastermind_

[plantuml,mastermindVersion4,svg]

....

class  mastermind.ConsoleMastermind{
+ ConsoleMastermind()
+ {static} main(String[]): void
# createView(Game): View
}
mastermind.Mastermind <|-down- mastermind.ConsoleMastermind

class  mastermind.GraphicsMastermind{
+ GraphicsMastermind()
+ {static} main(String[]): void
# createView(Game): View
}
mastermind.Mastermind <|-down- mastermind.GraphicsMastermind

class  mastermind.Mastermind{
- game: Game
- view: View
# Mastermind()
# {abstract} createView(Game): View
# play(): void
}
mastermind.Mastermind --> mastermind.views.View
mastermind.Mastermind --> mastermind.models.Game

....

=== Paquete _mastermind.views_

[plantuml,mastermindViewsVersion4,svg]

....

class  mastermind.views.Color{
+ {static} RED: Color
+ {static} BLUE: Color
+ {static} YELLOW: Color
+ {static} GREEN: Color
+ {static} ORANGE: Color
+ {static} PURPLE: Color
- initial: char
- Color(char)
+ {static} valueOf(String): Color
+ {static} getInstance(char): Color
+ {static} getInstance(int): Color
+ getInitial(): char
+ {static} allInitials(): String
}

class  mastermind.views.Error{
+ {static} DUPLICATED: Error
+ {static} WRONG_CHARACTERS: Error
+ {static} WRONG_LENGTH: Error
- message: String
- Error(String)
+ {static} valueOf(String): Error
+ getMessage(): String
}

class  mastermind.views.Message{
+ {static} TURN: Message
+ {static} SECRET: Message
+ {static} RESUME: Message
+ {static} RESULT: Message
+ {static} PROPOSED_COMBINATION: Message
+ {static} TITLE: Message
+ {static} WINNER: Message
+ {static} LOOSER: Message
- message: String
- Message(String)
+ {static} valueOf(String): Message
+ getMessage(): String
}

class  mastermind.views.View{
# game: Game
+ View(Game)
# {abstract} start(): void
# {abstract} resume(): boolean
+ interact(): void
# {abstract} propose(): boolean
}
mastermind.views.View *-down-> mastermind.models.Game

....

=== Paquete _mastermind.views.console_

[plantuml,mastermindViewsConsoleVersion4,svg]

....

class  mastermind.views.console.ConsoleView{
- startView: StartView
- proposalView: ProposalView
- resumeView: ResumeView
+ ConsoleView(Game)
# start(): void
# resume(): boolean
# propose(): boolean
}
mastermind.views.View <|-down- mastermind.views.console.ConsoleView
mastermind.views.console.ConsoleView *-down-> mastermind.views.console.ProposalView
mastermind.views.console.ConsoleView *-down-> mastermind.views.console.ResumeView
mastermind.views.console.ConsoleView *-down-> mastermind.views.console.StartView

class  mastermind.views.console.ProposalView{
~ ProposalView()
~ interact(Game): boolean
- proposeCombination(int[], Game): int
}
mastermind.utils.WithConsoleView <|-down- mastermind.views.console.ProposalView
mastermind.views.console.ProposalView ..> mastermind.models.Game
mastermind.views.console.ProposalView ..> mastermind.views.console.ProposedCombinationView
mastermind.views.console.ProposalView ..> mastermind.views.console.SecretCombinationView
mastermind.views.console.ProposalView ..> mastermind.views.console.ResultView

class  mastermind.views.console.ProposedCombinationView{
- {static} ERROR_CODE: int
~ ProposedCombinationView()
~ write(int[]): void
~ read(): int[]
}
mastermind.utils.WithConsoleView <|-down- mastermind.views.console.ProposedCombinationView

class  mastermind.views.console.ResultView{
~ ResultView()
~ writeln(int[]): void
}
mastermind.utils.WithConsoleView <|-down- mastermind.views.console.ResultView

class  mastermind.views.console.ResumeView{
~ ResumeView()
~ interact(Game): boolean
}
mastermind.views.console.ResumeView ..> mastermind.models.Game

class  mastermind.views.console.SecretCombinationView{
~ SecretCombinationView()
~ writeln(int): void
}
mastermind.utils.WithConsoleView <|-down- mastermind.views.console.SecretCombinationView

class  mastermind.views.console.StartView{
~ StartView()
~ interact(Game): void
}
mastermind.utils.WithConsoleView <|-down- mastermind.views.console.StartView
mastermind.views.console.StartView ..> mastermind.models.Game
mastermind.views.console.StartView..> mastermind.views.console.SecretCombinationView

....

=== Paquete _mastermind.views.graphics_

[plantuml,mastermindViewsGraphicsVersion4,svg]

....

class  mastermind.views.graphics.Constraints{
~ Constraints(int, int, int, int)
}
java.awt.GridBagConstraints <|-down- mastermind.views.graphics.Constraints

class  mastermind.views.graphics.GameView{
- {static} GAME_OVER: String
- secretCombinationView: SecretCombinationView
- proposedCombinationsView: ProposedCombinationsView
- proposalCombinationView: ProposalCombinationView
~ GameView()
- clear(): void
~ start(Game): void
~ propose(Game): boolean
- proposeCombination(Game, int[]): int
- drawGameOver(Game): boolean
}
javax.swing.JFrame <|-down- mastermind.views.graphics.GameView
mastermind.views.graphics.GameView *-down-> mastermind.views.graphics.ProposedCombinationsView
mastermind.views.graphics.GameView *-down-> mastermind.views.graphics.SecretCombinationView
mastermind.views.graphics.GameView *-down-> mastermind.views.graphics.ProposalCombinationView
mastermind.views.graphics.GameView ..> mastermind.models.Game
mastermind.views.graphics.GameView ..> mastermind.views.graphics.ProposedCombinationView
mastermind.views.graphics.GameView ..> mastermind.views.graphics.Constraints

class  mastermind.views.graphics.GraphicsView{
- gameView: GameView
+ GraphicsView(Game)
# start(): void
# resume(): boolean
# propose(): boolean
}
mastermind.views.View <|-down- mastermind.views.graphics.GraphicsView
mastermind.views.graphics.GraphicsView *-down-> mastermind.views.graphics.GameView
mastermind.views.graphics.GraphicsView ..> mastermind.views.graphics.ResumeDialog

class  mastermind.views.graphics.ProposalCombinationView{
- {static} ACCEPT: String
- label: JLabel
- textField: JTextField
- button: JButton
- characters: String
~ ProposalCombinationView(JRootPane)
+ keyPressed(KeyEvent): void
+ keyReleased(KeyEvent): void
+ keyTyped(KeyEvent): void
~ resetCharacters(): void
~ getCharacters(): String
+ actionPerformed(ActionEvent): void
}
java.awt.event.KeyListener <|-down- mastermind.views.graphics.ProposalCombinationView
java.awt.event.ActionListener <|-down- mastermind.views.graphics.ProposalCombinationView
javax.swing.JPanel <|-down- mastermind.views.graphics.ProposalCombinationView
mastermind.views.graphics.ProposalCombinationView *-down-> javax.swing.JButton
mastermind.views.graphics.ProposalCombinationView *-down-> javax.swing.JTextField
mastermind.views.graphics.ProposalCombinationView *-down-> javax.swing.JLabel
mastermind.views.graphics.ProposalCombinationView ..> javax.swing.JRootPane
mastermind.views.graphics.ProposalCombinationView ..> java.awt.event.KeyEvent
mastermind.views.graphics.ProposalCombinationView ..> java.awt.event.ActionEvent
mastermind.views.graphics.ProposalCombinationView..> mastermind.views.graphics.Constraints

class  mastermind.views.graphics.ProposedCombinationsView{
~ ProposedCombinationsView()
~ add(Game): void
}
javax.swing.JPanel <|-down- mastermind.views.graphics.ProposedCombinationsView
mastermind.views.graphics.ProposedCombinationsView ..> mastermind.models.Game
mastermind.views.graphics.ProposedCombinationsView..> mastermind.views.graphics.Constraints
mastermind.views.graphics.ProposedCombinationsView ..> mastermind.views.graphics.TurnView
mastermind.views.graphics.ProposedCombinationsView..> mastermind.views.graphics.ProposedCombinationView
mastermind.views.graphics.ProposedCombinationsView..> mastermind.views.graphics.ResultView

class  mastermind.views.graphics.ProposedCombinationView{
~ {static} ERROR_CODE: int
~ ProposedCombinationView(int[])
~ ProposedCombinationView()
~ read(String): int[]
}
javax.swing.JLabel <|-down- mastermind.views.graphics.ProposedCombinationView
mastermind.views.graphics.ProposedCombinationView..> mastermind.views.graphics.ProposedCombinationView

class  mastermind.views.graphics.ResultView{
~ ResultView(int[])
}
javax.swing.JLabel <|-down- mastermind.views.graphics.ResultView

class  mastermind.views.graphics.ResumeDialog{
- resume: boolean
~ ResumeDialog()
~ isResumed(): boolean
}

class  mastermind.views.graphics.SecretCombinationView{
- {static} TITLE: String
- title: JLabel
- secretCombination: JLabel
~ SecretCombinationView(int)
}
javax.swing.JPanel <|-down- mastermind.views.graphics.SecretCombinationView
mastermind.views.graphics.SecretCombinationView *-down-> javax.swing.JLabel
mastermind.views.graphics.SecretCombinationView..> mastermind.views.graphics.Constraints

class  mastermind.views.graphics.TurnView{
~ TurnView(int)
}
javax.swing.JLabel <|-down- mastermind.views.graphics.TurnView

....

=== Paquete _mastermind.models_

[plantuml,mastermindModelVersion4,svg]

....

class  mastermind.models.Color{
+ {static} RED: Color
+ {static} BLUE: Color
+ {static} YELLOW: Color
+ {static} GREEN: Color
+ {static} ORANGE: Color
+ {static} PURPLE: Color
- Color()
+ {static} valueOf(String): Color
~ {static} length(): int
~ {static} getInstance(int): Color
}

class  mastermind.models.Combination{
- {static} WIDTH: int
# colors: List<Color>
# Combination()
+ {static} getWidth(): int
}
mastermind.models.Combination *-down-> java.util.List
mastermind.models.Combination *-down-> mastermind.models.Color

class  mastermind.models.Error{
+ {static} DUPLICATED: Error
+ {static} WRONG_CHARACTERS: Error
+ {static} WRONG_LENGTH: Error
- Error()
+ {static} valueOf(String): Error
}

class  mastermind.models.Game{
+ {static} NO_ERROR: int
- {static} MAX_LONG: int
- secretCombination: SecretCombination
- proposedCombinations: List<ProposedCombination>
- results: List<Result>
- turn: int
+ Game()
+ clear(): void
+ proposeCombination(ProposedCombination): void
+ getCodes(): int[][][]
+ isLooser(): boolean
+ getTurn(): int
+ getWidth(): int
+ isWinner(): boolean
}
mastermind.models.Game *-down-> java.util.List
mastermind.models.Game *-down-> mastermind.models.SecretCombination
mastermind.models.Game *-down-> mastermind.models.Result
mastermind.models.Game --> mastermind.models.ProposedCombination

class  mastermind.models.ProposedCombination{
+ ProposedCombination()
~ contains(Color): boolean
~ contains(Color, int): boolean
+ {static} getInstance(int[]): ProposedCombination
+ {static} isValid(int[]): Error
~ getCodes(): int[]
}
mastermind.models.Combination <|-down- mastermind.models.ProposedCombination
mastermind.models.ProposedCombination ..> mastermind.models.Error

class  mastermind.models.Result{
- blacks: int
- whites: int
~ Result(int, int)
~ getCodes(): int[]
~ isWinner(): boolean
}

class  mastermind.models.SecretCombination{
~ SecretCombination()
~ getResult(ProposedCombination): Result
}
mastermind.models.Combination <|-down- mastermind.models.SecretCombination
mastermind.models.SecretCombination ..> mastermind.models.Result
mastermind.models.SecretCombination ..> mastermind.models.ProposedCombination

....

=== Paquete _mastermind.utils_

[plantuml,mastermindUtilsVersion4,svg]

....

class  mastermind.utils.ClosedInterval{
- min: int
- max: int
+ ClosedInterval(int, int)
+ includes(int): boolean
}

class  mastermind.utils.Console{
- bufferedReader: BufferedReader
+ Console()
+ write(char): void
+ write(String): void
+ readInt(String): int
+ readChar(String): char
+ writeln(int): void
+ writeln(String): void
+ writeln(): void
- writeError(String): void
+ readString(String): String
}
mastermind.utils.Console *-down-> java.io.BufferedReader

class  mastermind.utils.WithConsoleView{
# console: Console
# WithConsoleView()
}
mastermind.utils.WithConsoleView *-down-> mastermind.utils.Console

class  mastermind.utils.YesNoDialog{
- {static} AFIRMATIVE: char
- {static} NEGATIVE: char
- {static} QUESTION: String
- {static} MESSAGE: String
+ YesNoDialog()
+ read(String): boolean
- {static} isAfirmative(char): boolean
- {static} isNegative(char): boolean
}
mastermind.utils.WithConsoleView <|-down- mastermind.utils.YesNoDialog

....

== Calidad del Software

=== Diseño

- [red line-through]*_[red]#DRY: clases principales#_*

=== Rediseño

- _Nuevas funcionalidades: undo/redo, demo, estadísiticas,..._
* [red]#_**Clases Grandes**: los Modelos asumen la responsabilidad y crecen en líneas, métodos, atributos, ... con las nuevas funcionalidades_#
* [red]#_**Open/Close**: hay que modificar los modelos que estaban funcionando previamente para incorporar nuevas funcionalidades_#

== Vista de Desarrollo/Implementación

[plantuml,diagramaImplementacion,svg]
....

package "  "  as mastermind {
}
package "  "  as mastermind.models {
}
package "  "  as mastermind.views {
}
package "  "  as mastermind.views.console {
}
package "  "  as mastermind.views.graphics {
}
package "  "  as mastermind.utils {
}
package "  "  as java.io {
}
package "  "  as java.util {
}
package "  "  as java.awt {
}
package "  "  as java.awt.event {
}
package "  "  as javax.swing {
}

[mastermind.jar] as jar

jar *--> mastermind
jar *--> mastermind.models
jar *--> mastermind.views
jar *--> mastermind.views.console
jar *--> mastermind.views.graphics
jar *--> mastermind.utils
jar *--> java.io
jar *--> java.util
jar *--> java.awt
jar *--> java.awt.event
jar *--> javax.swing
....


== Vista de Despliegue/Física

[plantuml,diagramaDespliegue,svg]
....

node node #DDDDDD [
<b>Personal Computer</b>
----
memory : xxx Mb
cpu : xxx GHz
]

[ masterming.jar ] as component

node *--> component
....

== Vista de Procesos

- No hay concurrencia

